@model HotelGarage.Core.ViewModel.ParkingViewModel

@{
    ViewBag.Title = "Parking overview";
}

<h4>Outside parking</h4>

<div class="container">

    <div class="row">
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[12])
        </div>
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[13])
        </div>
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[14])
        </div>
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[15])
        </div>
    </div>
    <div class="row">
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[19])
        </div>
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[21])
        </div>
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[22])
        </div>
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[24])
        </div>
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[16])
        </div>
    </div>
    <div class="row">
        <div class="emptyParkingPlace">
        </div>
        <div class="emptyParkingPlace">
        </div>
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[23])
        </div>
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[25])
        </div>
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[17])
        </div>
    </div>
    <div class="row">
        <div class="emptyParkingPlace">
        </div>
        <div class="emptyParkingPlace">
        </div>
        <div class="emptyParkingPlace">
        </div>
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[26])
        </div>
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[18])
        </div>
    </div>
    <div class="row">
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[20])
        </div>
        <div class="emptyParkingPlace">
        </div>
        <div class="emptyParkingPlace">
        </div>
        <div class="card">
            @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[27])
        </div>
    </div>

</div>
<br />

<div class="container">
    <div class="row">
        <div class="col-auto">
            <h4>Garage</h4>
            <div class="row">
                <div class="card">
                    @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[11])
                </div>
                <div class="emptyParkingPlace">
                </div>
                <div class="emptyParkingPlace">
                </div>
            </div>
            <div class="row">
                <div class="card">
                    @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[10])
                </div>
            </div>
            <div class="row">
                <div class="card">
                    @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[9])
                </div>
                <div class="emptyParkingPlace">
                </div>
                <div class="card">
                    @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[0])
                </div>
            </div>
            <div class="row">
                <div class="card">
                    @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[8])
                </div>
                <div class="emptyParkingPlace">
                </div>
                <div class="card">
                    @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[1])
                </div>
            </div>
            <div class="row">
                <div class="card">
                    @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[7])
                </div>
                <div class="emptyParkingPlace">
                </div>
                <div class="card">
                    @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[2])
                </div>
            </div>
            <div class="row">
                <div class="card">
                    @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[6])
                </div>
                <div class="emptyParkingPlace">
                </div>
                <div class="card">
                    @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[3])
                </div>
            </div>
            <div class="row">
                <div class="card">
                    @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[5])
                </div>
                <div class="emptyParkingPlace">
                </div>
                <div class="card">
                    @Html.Partial("_ParkingPlace", Model.ParkingPlaceDtos[4])
                </div>
            </div>
        </div>
        <div class="col-auto">
            <h4 class="text-center">Number of free places for the next 7 days</h4>
            <div>
                <div class="row alert alert-info">
                    <div style="margin:auto;">
                        <div class="row">
                            <div class="freeParkingPlaces">
                                @DateTime.Today.AddDays(0).ToString("dd. MM.")<br />
                                @Model.OccupancyNumbers[0].FreePlacesCount
                                (@Model.OccupancyNumbers[0].OccupiedByEmployeesCount)
                            </div>
                            <div class="freeParkingPlaces">

                                @DateTime.Today.AddDays(1).ToString("dd. MM.")<br />
                                @Model.OccupancyNumbers[1].FreePlacesCount
                                (@Model.OccupancyNumbers[1].OccupiedByEmployeesCount)
                            </div>
                            <div class="freeParkingPlaces">
                                @DateTime.Today.AddDays(2).ToString("dd. MM.")<br />
                                @Model.OccupancyNumbers[2].FreePlacesCount
                                (@Model.OccupancyNumbers[2].OccupiedByEmployeesCount)
                            </div>
                            <div class="freeParkingPlaces">
                                @DateTime.Today.AddDays(3).ToString("dd. MM.")<br />
                                @Model.OccupancyNumbers[3].FreePlacesCount
                                (@Model.OccupancyNumbers[3].OccupiedByEmployeesCount)
                            </div>
                            <div class="freeParkingPlaces">
                                @DateTime.Today.AddDays(4).ToString("dd. MM.")<br />
                                @Model.OccupancyNumbers[4].FreePlacesCount
                                (@Model.OccupancyNumbers[4].OccupiedByEmployeesCount)
                            </div>
                            <div class="freeParkingPlaces">
                                @DateTime.Today.AddDays(5).ToString("dd. MM.")<br />
                                @Model.OccupancyNumbers[5].FreePlacesCount
                                (@Model.OccupancyNumbers[5].OccupiedByEmployeesCount)
                            </div>
                            <div class="freeParkingPlaces">
                                @DateTime.Today.AddDays(6).ToString("dd. MM.")<br />
                                @Model.OccupancyNumbers[6].FreePlacesCount
                                (@Model.OccupancyNumbers[4].OccupiedByEmployeesCount)
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-center">
                * in brackets is a number of places occupied by employees<br>
                * staff places are not counted into the occupancy<br>
            </div>
            <br />
            @if (Model.NoShowReservations.Count != 0)
            {
                <h4 class="text-center">No show reservations</h4>
                <div>
                    @foreach (var reservation in Model.NoShowReservations)
                    {
                        <div class="row alert alert-danger">
                            <div class="alert-prijezd">
                                LP: @reservation.CarLicensePlate<br />
                                <div class="js-parkingPlacePrijezd">Place: @reservation.ParkingPlaceName<br /></div>
                                Name: @reservation.CarGuestsName<br />
                                Arrival: @reservation.Arrival
                            </div>
                            <div class="ml-auto">
                                <div class="input-group justify-content-center">
                                    @Html.DropDownListFor(m => m.FreeParkingPlaceNames,
                                        new SelectList(Model.FreeParkingPlaceNames),
                                        new
                                        {
                                            @class = "custom-select disabled",
                                            @id = "inputGroupSelect04",
                                            value = reservation.ParkingPlaceId,
                                            disabled = "disabled"
                                        })
                                    <div class="input-group-append">
                                        <button id="select-link" data-id='@reservation.Id'
                                                class="btn btn-warning select-link" type="submit" disabled="disabled">
                                            Assign place
                                        </button>
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div>
                                        @Html.ActionLink("Update",
                                            "Update",
                                            "Reservation",
                                            new { reservationId = reservation.Id },
                                            new { @class = "nav-link odkaz-prijezd" })
                                    </div>
                                    <div class="nav-link">|</div>
                                    <div style="text-align:center">
                                        @Html.ActionLink("Delete",
                                            "Delete",
                                            "Reservation",
                                            new { reservationId = reservation.Id },
                                            new { @class = "nav-link odkaz-prijezd js-delete", @onclick = "return confirm('Are you sure to delete the reservation?')"})
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                </div>
                <br />}
            @if (Model.TodaysReservations.Count != 0)
            {
                <h4 class="text-center">Today's reservations</h4>
                <div>
                    @{int i = 0;}
                    @foreach (var reservation in Model.TodaysReservations)
                    {
                        <div class="row alert alert-warning">
                            <div class="alert-prijezd">
                                LP: @reservation.CarLicensePlate<br />
                                <div class="js-parkingPlacePrijezd">Place: @reservation.ParkingPlaceName<br /></div>
                                Name: @reservation.CarGuestsName<br />
                                Arrival: @reservation.Arrival
                            </div>
                            <div class="ml-auto">
                                <div class="input-group justify-content-center">
                                    @Html.DropDownListFor(r => r.FreeParkingPlaceNames,
                                         new SelectList(Model.FreeParkingPlaceNames),
                                         new { @class = "custom-select", @id = "inputGroupSelect04",
                                             value = reservation.ParkingPlaceId, value_id = i,
                                             buttonType = "arriving" })
                                    <div class="input-group-append">
                                        <button id="select-link" data-id='@reservation.Id'
                                                class="btn btn-warning select-link" type="submit" value-id='@i'
                                                buttonType="arriving">
                                            Assign place
                                        </button>
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div>
                                        @Html.ActionLink("Update",
                                             "Update",
                                             "Reservation",
                                             new { reservationId = reservation.Id },
                                             new { @class = "nav-link odkaz-prijezd" })
                                    </div>
                                    <div class="nav-link">|</div>
                                    <div style="text-align:center">
                                        @Html.ActionLink("Delete",
                                             "Delete",
                                             "Reservation",
                                             new { reservationId = reservation.Id },
                                                 // kontrola zda nejde o docasne vyjetou rezervaci
                                                 (reservation.State == HotelGarage.Core.Model.ReservationState.TemporaryLeave) ?
                                                     new { @class = "nav-link odkaz-prijezd disabled", @onclick = "javascript:return false;" } :
                                                     (object)new { @class = "nav-link odkaz-prijezd",
                                                         @onclick = "return confirm('Are you sure to delete the reservation?')" })
                                    </div>
                                    <div class="nav-link">|</div>
                                    <div style="text-align:center">
                                        @Html.ActionLink("Check In",
                                             "CheckIn",
                                             "Parking",
                                             new { parkingPlaceId = reservation.ParkingPlaceId,
                                                 reservationId = reservation.Id }, (reservation.ParkingPlaceName == "Not assigned") ?
                                                     new { @class = "nav-link odkaz-prijezd disabled", @onclick = "javascript:return false;" }
                                                     : (object)new { @class = "nav-link odkaz-prijezd",
                                                         @onclick = "return confirm('Are you sure to check in the reservation?')" })
                                    </div>
                                </div>
                            </div>
                        </div>
                        i++;
                    }
                </div>
                <br />}
            @if (Model.InHouseReservations.Count != 0)
            {
                <h4 class="text-center">Parked cars</h4>
                <div>
                    @{int i = 0;}
                    @foreach (var reservation in Model.InHouseReservations)
                    {
                        <div class="row alert alert-primary">
                            <div class="alert-prijezd">
                                LP: @reservation.CarLicensePlate<br />
                                <div class="js-parkingPlacePrijezd">Place: @reservation.ParkingPlaceName<br /></div>
                                Name: @reservation.CarGuestsName<br />
                                Arrival: @reservation.Arrival
                            </div>
                            <div class="ml-auto">
                                <div class="input-group justify-content-center">
                                    @Html.DropDownListFor(m => m.FreeParkingPlaceNames,
                                       new SelectList(Model.FreeParkingPlaceNames),
                                       new
                                       {
                                           @class = "custom-select",
                                           @id = "inputGroupSelect04",
                                           value = reservation.ParkingPlaceId,
                                           value_id = i,
                                           buttonType = "inhouse"
                                       })
                                    <div class="input-group-append">
                                        <button id="select-link" data-id='@reservation.Id'
                                                class="btn btn-warning select-link" type="submit" value-id='@i'
                                                buttonType="inhouse">
                                            Assign Place
                                        </button>
                                    </div>
                                </div>
                                <div class="row justify-content-center">
                                    <div>
                                        @Html.ActionLink("Update",
                                           "Update",
                                           "Reservation",
                                           new { reservationId = reservation.Id },
                                           new { @class = "nav-link odkaz-prijezd" })
                                    </div>
                                    <div class="nav-link">|</div>
                                    <div style="text-align:center" id=@reservation.ParkingPlaceId>
                                        <a href="javascript:void()" class="nav-link js-checkout odkaz-prijezd"
                                           isregistered="@reservation.IsRegistered.ToString()"
                                           data-bbox-spz="@reservation.CarLicensePlate"
                                           data-bbox-odjezd="@reservation.Departure">Check Out</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        i++;
                    }
                </div>
                <br />}
        </div>
    </div>
</div>
@section scripts
{
    <script>
        $(document).ready(function () {
            ParkingPlace.init();
        });
    </script>
}
